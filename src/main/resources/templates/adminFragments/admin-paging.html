<div th:fragment="pageSection(page)">
    <style>
        .ff-pagination-wrap{
            background: rgba(255,255,255,.75);
            border: 1px solid rgba(31,41,55,.08);
            border-radius: 16px;
            padding: 14px 14px;
            box-shadow: 0 18px 45px rgba(31, 41, 55, 0.06);
        }

        .ff-pagination{
            gap: 8px;
            flex-wrap: wrap;
        }

        .ff-pagination .page-item .page-link{
            border: 1px solid rgba(31,41,55,.10);
            background: rgba(47, 93, 98, 0.06); /* primary soft */
            color: var(--dark);
            border-radius: 999px;
            padding: 8px 14px;
            font-weight: 600;
            transition: 0.18s ease;
        }

        .ff-pagination .page-item .page-link:hover{
            transform: translateY(-1px);
            background: rgba(47, 93, 98, 0.10);
            border-color: rgba(47, 93, 98, 0.25);
        }

        .ff-pagination .page-item.active .page-link{
            background: var(--primary);
            color: #fff;
            border-color: var(--primary);
            box-shadow: 0 10px 25px rgba(47, 93, 98, 0.25);
        }

        .ff-pagination .page-item.disabled .page-link{
            opacity: 0.45;
            pointer-events: none;
            background: rgba(255,255,255,.6);
        }

        /* Results selector */
        .ff-results-label{
            color: var(--muted);
            font-weight: 600;
            font-size: 0.95rem;
        }

        .ff-select{
            border-radius: 12px;
            border: 1px solid rgba(31,41,55,.12);
            background: rgba(255,255,255,.85);
            color: var(--dark);
            padding: 8px 10px;
            font-weight: 600;
        }

        .ff-total{
            background: rgba(183, 121, 108, 0.12); /* accent soft */
            border: 1px solid rgba(183, 121, 108, 0.18);
            padding: 6px 10px;
            border-radius: 999px;
            font-weight: 800;
            color: var(--dark);
        }
    </style>

    <div class="ff-pagination-wrap">
        <div class="row align-items-center g-3">
            <div class="col-lg-8">
                <nav aria-label="Page navigation">
                    <ul class="pagination ff-pagination mb-0">
                        <li class="cursor-pointer page-item" th:classappend="${page.isFirst()} ? 'disabled' : ''">
                            <a class="page-link" href="#"
                               onClick="updateQueryStringParameter('pageNum', 1)">First</a>
                        </li>

                        <li class="page-item" th:classappend="${page.hasPrevious()} ? '' : 'disabled'">
                            <a class="page-link" href="#"
                               onClick="updateQueryStringParameter('pageNum', this.getAttribute('page-number'))"
                               th:page-number="${page.number}">Previous</a>
                        </li>

                        <li th:each="pageNum : ${#numbers.sequence(T(java.lang.Math).max(1,page.number-5), (page.totalPages == 0? 1: T(java.lang.Math).min(page.totalPages,page.number+5)))}"
                            th:class="${page.number+1 == pageNum} ? 'page-item active' : 'page-item'">
                            <a class="page-link" href="#"
                               onClick="updateQueryStringParameter('pageNum', this.getAttribute('page-number'))"
                               th:page-number="${pageNum}" th:text="${pageNum}"></a>
                        </li>

                        <li class="page-item" th:classappend="${page.hasNext()} ? '' : 'disabled'">
                            <a class="page-link" href="#"
                               onClick="updateQueryStringParameter('pageNum', this.getAttribute('page-number'))"
                               th:page-number="${page.number+2}">Next</a>
                        </li>

                        <li class="page-item" th:classappend="${page.isLast()} ? 'disabled' : ''">
                            <a class="page-link" href="#"
                               onClick="updateQueryStringParameter('pageNum', this.getAttribute('page-number'))"
                               th:page-number="${page.totalPages}">Last</a>
                        </li>
                    </ul>
                </nav>
            </div>

            <div class="col-lg-4">
                <div class="d-flex align-items-center justify-content-lg-end gap-2 mb-0">
                    <span class="ff-results-label">Results:</span>

                    <select id="results" class="ff-select"
                            onchange="updateQueryStringParameter('pageSize',this.value)">
                        <option value="10" th:selected="${page.size == 10}">10</option>
                        <option value="20" th:selected="${page.size == 20}">20</option>
                        <option value="50" th:selected="${page.size == 50}">50</option>
                        <option value="100" th:selected="${page.size == 100}">100</option>
                        <option value="1000" th:selected="${page.size == 1000}">1000</option>
                    </select>

                    <span class="ff-results-label">Total:</span>
                    <span class="ff-total" th:text="${page.totalElements}"></span>
                </div>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
        function updateQueryStringParameter(key, value) {
            var uri = window.location.href;
            var re = new RegExp("([?&])" + key + "=.*?(&|$)", "i");
            var separator = uri.indexOf('?') !== -1 ? "&" : "?";
            if (uri.match(re)) {
                uri = uri.replace(re, '$1' + key + "=" + value + '$2');
            } else {
                uri = uri + separator + key + "=" + value;
            }
            window.location = uri;
        }
    </script>
</div>